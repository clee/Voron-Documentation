<h1 id="initial-startup-checks">Initial Startup Checks</h1>

<p>This section provides a list of steps to help confirm the pin settings in the Klipper printer.cfg file. 
During this guide, it may be necessary to make changes to the Klipper config file. Be sure to issue a <code class="language-plaintext highlighter-rouge">RESTART</code> command after every change to the config file to ensure that the change takes effect (type “restart” in the Octoprint or Mainsail terminal and then click “Send”). It’s also a good idea to issue a <code class="language-plaintext highlighter-rouge">STATUS</code> command after every <code class="language-plaintext highlighter-rouge">RESTART</code> to verify that the config file is successfully loaded.</p>

<p>Any time commands are requested to be issued, those will happen in the ‘Terminal’ tab of the OctoPrint, Mainsail, or Fluidd web UI, in the box for entering commands directly.</p>

<p><img src="./images/octoprint_terminal_tab.png" alt="" /></p>

<p><img src="./images/mainsail_terminal.png" alt="" /></p>

<p>Any time movements need to be made, those will happen in the ‘Control’ tab / section of the Octoprint, Mainsail, or Fluidd web UI. The numbers underneath X, Y, and Z control the movement distance.</p>

<p><img src="./images/Octoprint_Controls.png" alt="" /></p>

<p><img src="./images/mainsail_controls.png" alt="" /></p>

<h2 id="verify-temperature">Verify Temperature</h2>

<p>Start by verifying that temperatures are being properly reported. Navigate to the Octoprint/Mainsail temperature graph.</p>

<p><img src="./images/mainsail_temp_graph.png" alt="" /></p>

<p><img src="./images/octoprint_temp_graph.png" alt="" /></p>

<p>Verify that the temperature of the nozzle and bed are present and <strong>not increasing</strong>. If it is increasing, remove power from the printer. If the temperatures are not accurate, review the “sensor_type” and “sensor_pin” settings for the extruder and/or bed.</p>

<h2 id="verify-heaters">Verify heaters</h2>

<p>Navigate to the OctoprintMainsail temperature graph and type in 50 followed by enter in the “Tool” temperature target feild. The extruder temperature in the graph should start to increase (within about 30 seconds or so). Then go to the “Tool” temperature drop-down box and select “Off”. After several minutes the temperature should start to return to its initial room temperature value. If the temperature does not increase then verify the “heater_pin” setting in the config.</p>

<p>perform the above test again with the bed.</p>

<h2 id="stepper-motor-check">Stepper Motor Check</h2>

<p>To verify that each stepper motor is operating correctly, send the following command in the terminal:</p>

<p><code class="language-plaintext highlighter-rouge">STEPPER_BUZZ STEPPER=stepper_x</code></p>

<p>Run this command for each of the motors:</p>

<h3 id="v0-sw">V0, SW</h3>
<ul>
  <li>stepper_x</li>
  <li>stepper_y</li>
  <li>stepper_z</li>
  <li>extruder</li>
</ul>

<h3 id="v1-legacy">V1, Legacy</h3>
<ul>
  <li>stepper_x</li>
  <li>stepper_y</li>
  <li>stepper_z</li>
  <li>stepper_z1</li>
  <li>extruder</li>
</ul>

<h3 id="trident">Trident</h3>
<ul>
  <li>stepper_x</li>
  <li>stepper_y</li>
  <li>stepper_z</li>
  <li>stepper_z1</li>
  <li>stepper_z2</li>
  <li>extruder</li>
</ul>

<h3 id="v2">V2</h3>
<ul>
  <li>stepper_x</li>
  <li>stepper_y</li>
  <li>stepper_z</li>
  <li>stepper_z1</li>
  <li>stepper_z2</li>
  <li>stepper_z3</li>
  <li>extruder</li>
</ul>

<p>The STEPPER_BUZZ command will cause the given stepper to move one millimeter in a positive direction and then it will return to its starting position. (If the endstop is defined at position_endstop=0 then at the start of each movement the stepper will move away from the endstop.) It will perform this oscillation ten times.</p>

<p>If the stepper does not move at all, then verify the “enable_pin” and “step_pin” settings for the stepper. If the stepper motor moves but does not return to its original position then verify the “dir_pin” setting. If the stepper motor oscillates in an incorrect direction, then it generally indicates that the “dir_pin” for the axis needs to be inverted. This is done by adding a ‘!’ to the “dir_pin” in the printer config file (or removing it if one is already there). If the motor moves significantly more or significantly less than one millimeter then verify the “rotation_distance” setting.</p>

<h4 id="v2-motor-positions-others-may-vary">V2 motor positions (Others may vary)</h4>

<p><img src="./images/V2-motor-positions.png" alt="" /></p>

<h2 id="endstop-check">Endstop Check</h2>

<p>Make sure that none of the X, Y, or Z endstops are being pressed.  Then send a <code class="language-plaintext highlighter-rouge">QUERY_ENDSTOPS</code> command.  The terminal window should respond with the following:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Send: QUERY_ENDSTOPS
Recv: x:open y:open z:open
</code></pre></div></div>

<p>If any of them say “triggered” instead of “open”, double-check to make sure none of them are pressed.  Next, manually press the X endstop switch, send the <code class="language-plaintext highlighter-rouge">QUERY_ENDSTOPS</code> command again, and make sure that the X enstop says “triggered and the Y and Z endstops stay open.  Repeat with the Y and Z endstops.</p>

<p>If it is found that one of the endstops has inverted login (i.e. it reads as “open” when it is pressed and “triggered” when not pressed), go into the printer configuration file (typically printer.cfg) and add or remove the ! in front of the pin identifier. For example, if the X endstop was inverted, add a ! in front of the pin number as follows:</p>

<p><code class="language-plaintext highlighter-rouge">endstop_pin: P1.28</code> -&gt; <code class="language-plaintext highlighter-rouge">endstop_pin: !P1.28</code></p>

<h2 id="xy-homing-check">XY Homing Check</h2>

<p>At this point everything is ready to home X and Y.</p>

<p><strong>Important:</strong> You need to be able to quickly stop the printer in case something goes wrong (e.g. the tool head goes the wrong direction).  There are a few ways of doing this:</p>

<ol>
  <li>Use the E-stop button on the display (if installed).  On the Mini12864 it is the small button underneath the main control knob.  Test the button and see what happens -  Klipper should shut down. Raspberry Pi and OctoPrint/Mainsail/Fluidd should still be running but disconnected from Klipper.  Press “Connect” in the upper left corner of OctoPrint, then in the Octoprint terminal window send a <code class="language-plaintext highlighter-rouge">FIRMWARE_RESTART</code> to get the printer back up and running.</li>
  <li>Have a computer right next to the printer with the <code class="language-plaintext highlighter-rouge">RESTART</code> or <code class="language-plaintext highlighter-rouge">M112</code> command already in the terminal command line in OctoPrint.  When you start homing the printer, if it goes in the wrong direction, quickly send the restart command and it will stop the printer.</li>
  <li>As a “nuclear” option, power off the printer with the power switch if something goes wrong.  This is not ideal because it may corrupt the files on the SD card and to recover would require reinstalling everything from scratch.</li>
</ol>

<p>Once there is a <em>tested</em> process for stopping the printer in case of something going wrong,  you can test X and Y movement.  <em>note: you will need to test X AND Y before you can correctly determine what adjustments are needed.</em>  First, send a <code class="language-plaintext highlighter-rouge">G28 X</code> command. This will only home X: The tool head should <em>move up slightly and then move to the right until it hits the X endstop</em>. If it moves any other direction, abort, take note, but still move on to testing Y. Next, test Y: run <code class="language-plaintext highlighter-rouge">G28 Y</code>.  The toolhead should move to the back of the printer until it hits the Y endstop. In a CoreXY configuration, both motors have to move in order to get the toolhead to go in only and X or Y direction (think Etch A Sketch). If the gantry moves downward first before moving to the right, you must reverse your z stepper directions in the config.</p>

<p>If either axis does not move the toolhead in the expected or correct direction, refer to the table below to figure out how to correct it.  If you need to invert the direction of one of the motors, invert the direction pin definition by adding a <code class="language-plaintext highlighter-rouge">!</code> to the pin name. For example, <code class="language-plaintext highlighter-rouge">dir_pin: PB2</code> would become <code class="language-plaintext highlighter-rouge">dir_pin: !PB2</code>.  (if the entry already has a <code class="language-plaintext highlighter-rouge">!</code>, remove it instead).   If the motors are going in directions that match the lower row of the chart, physically swap your X and Y (A and B) motor connectors on the MCU.</p>

<ul>
  <li>[stepper x] = Motor B</li>
  <li>[stepper y] = Motor A</li>
</ul>

<h2 id="motor-configuration-guides">Motor Configuration Guides</h2>

<h3 id="v0">V0:</h3>

<p><img src="./images/V0-motor-configuration-guide.png" alt="" /></p>

<h3 id="v1-legacy-1">V1, Legacy:</h3>

<p><img src="./images/V1-motor-configuration-guide.png" alt="" /></p>

<h3 id="trident-1">Trident:</h3>

<p><img src="./images/VT-motor-configuration-guide.png" alt="" /></p>

<h3 id="v2-1">V2:</h3>

<p><img src="./images/V2-motor-configuration-guide.png" alt="" /></p>

<h3 id="sw">SW:</h3>

<p><img src="./images/SW-motor-configuration-guide.png" alt="" /></p>

<p><strong>Important:</strong> Do not unplug or re-plug motors from MCUs without powering down the printer.  Damage to MCU may result.</p>

<h2 id="bed-locating-v2">Bed locating (V2)</h2>

<p>The print bed location of the V2 is much more adjustable than on any of the other models.  Before the 0,0 point and Z endstop locations are set, the physical locations of the Z endstop and print bed need to be finalized.</p>

<p>The Z endstop should be located to be in line with the nozzle, when the toolhead is at max Y position.  Home X and Y with <code class="language-plaintext highlighter-rouge">G28 X Y</code>  and then traverse just X to locate a Z endstop position at the maximum Y travel that will still trigger the endstop.  Lock down the Z endstop at that position.</p>

<p>Once the Z endstop is fixed into position the base plate should be adjusted so that the Z endstop pin is approximately 2-3mm from the aluminum base plate.  The base plate should be measured on each side to ensure it is centered and level / even with the front edge of the frame.  If in that process the extrusions the base is mounted on have to be moved, double-check the Z endstop to confirm it can still be reached. When tightening the mounting screws for the bed, a good practice is to have one screw tight, 2 firm, and the last one loose (best done hot).</p>

<h2 id="bed-locating-v1-trident-legacy">Bed locating (V1, Trident, Legacy)</h2>

<p>Before the 0,0 point and Z endstop locations are set, the physical locations of the Z endstop and print bed need to be finalized.</p>

<p>The Z endstop should be located at close to max X position.  Home X and Y with <code class="language-plaintext highlighter-rouge">G28 X Y</code>  and then traverse just Y to locate a Z endstop position at the maximum X travel that will still trigger the endstop.  Lock down the Z endstop at that position.</p>

<p>Once the Z endstop is fixed into position the base plate should be adjusted so that the Z endstop pin is approximately 2-3mm from the aluminum base plate.</p>

<h2 id="define-00-point-v0-v1-trident-v2-legacy">Define 0,0 Point (V0, V1, Trident, V2, Legacy)</h2>

<p>The homing position is not at the typical location of 0,0 but at the maximum travel location.  The actual numbers vary by printer build size.</p>

<p>Depending on bed location, the positional parameters may need to be adjusted to re-locate the 0,0 point.</p>

<ol>
  <li>Start by re-running <code class="language-plaintext highlighter-rouge">G28 X Y</code> to home X and Y.  After this, the nozzle will be at the maximum X,Y as defined by <em>position_max</em> under <em>[stepper_x]</em> and <em>[stepper_y]</em>.</li>
  <li>Using the OctoPrint or Mainsail controls, move the nozzle to the front left corner of the bed.</li>
  <li>If the from left corner of the bed cannot be reached within 3-5mm, the bed location needs to be physically adjusted (if possible). Move the bed on the extrusions or move the extrusions to get the bed location within range.
    <ul>
      <li>For V2, Make sure whatever bed position results still allows the nozzle to reach the Z endstop switch (See ‘Bed Locating’).</li>
      <li>If questionable, turn off motors and attempt to move the gantry by hand to see if the front left corner can physically be reached by the nozzle.</li>
    </ul>
  </li>
  <li>Once the nozzle is close to the front left corner of the bed but still on the bed, send an <code class="language-plaintext highlighter-rouge">M114</code> command to retrieve the current location.
    <ul>
      <li><em>Note: Due to other tolerances, it is usually not recommended to have the 0,0 exactly on the corner of the bed or build surface. Spec bed sizes are always slightly larger than the defined print volume so print volume loss will be minimal.</em></li>
    </ul>
  </li>
</ol>

<p>If X and Y offsets are less than 1mm and 0,0 is over the bed, nothing needs to be changed.</p>

<p>If X and Y offsets are within 5mm or 0,0 is past the bed, the <em>postition_max</em> values should be adjusted to change where the 0,0 point is computed.  If the 0,0 is over the bed, the distance from the home point to the front left (<em>position_max</em>) must be increased.  If the 0,0 is past the bed, the distance must be decreased. The amount is determined by the output of the <code class="language-plaintext highlighter-rouge">M114</code> command. Update <em>position_max</em> and <em>position_endstop</em> for both <em>[stepper_x]</em> and <em>[stepper_y]</em> as follows:</p>

<ul>
  <li>For X: New = Current - Get Position X (M114) Result</li>
  <li>For Y: New = Current - Get Position Y (M114) Result</li>
</ul>

<p><em>If the Z endstop pin location has been previously defined, be sure to re-follow the process to set the Z endstop pin location (if applicable).</em></p>

<p>If anything is updated in the printer configuration file, save the file and restart Klipper using <code class="language-plaintext highlighter-rouge">FIRMWARE_RESTART</code>.</p>

<h2 id="z-endstop-pin-location-v1-trident-v2-legacy">Z Endstop Pin Location (V1, Trident, V2, Legacy)</h2>

<ul>
  <li>Start by re-running <code class="language-plaintext highlighter-rouge">G28 X Y</code> to home X and Y.</li>
  <li>Using the software controls, move the nozzle until it is directly over the Z endstop switch.</li>
  <li>Send an <code class="language-plaintext highlighter-rouge">M114</code> command and record the X and Y values.</li>
  <li>Update the homing routing in the printer configuration file under <em>[homing_override]</em> or <em>[safe_z_home]</em> with those values.</li>
  <li>Restart Klipper with <code class="language-plaintext highlighter-rouge">FIRMWARE_RESTART</code>.</li>
  <li>Run a full <code class="language-plaintext highlighter-rouge">G28</code> and make sure that the printer properly homes X, Y, and Z.</li>
</ul>

<h2 id="z-endstop-location-v0">Z Endstop Location (V0)</h2>

<p>The V0 uses the bed assembly to contact the Z endstop switch via an adjustable screw in the T8 nut block. Ideally the activation of that switch will be at the exact bed height at which your nozzle also reaches the bed surface. However there is a window of travel from the moment that switch is activated to the point at which that switch bottoms out, this window is about 0.6mm. by using the adjustable screw in the T8 nut block and by being able to physically move the endstop switch up or down along the extrusion you need to position these so that the point at which your nozzle touches the bed (your Z0 point) happens within that 0.6mm window of travel. You can then use the <code class="language-plaintext highlighter-rouge">ENDSTOP_CALIBRATE</code>routine to then tell your printer where within that window you land, or in other words, what the offset between the z0 position and the endstop trigger point is.</p>

<h2 id="inductive-probe-check-v1-trident-v2-switchwire-legacy">Inductive Probe Check (V1, Trident, V2, Switchwire, Legacy)</h2>

<h3 id="probe-testing">Probe Testing</h3>

<p>With the toolhead in the center of the bed, reconfirm that the probe is working correctly.</p>

<p>When it is far from the bed, <code class="language-plaintext highlighter-rouge">QUERY_PROBE</code> should return “open”. When a metal object is close to the probe, <code class="language-plaintext highlighter-rouge">QUERY_PROBE</code> should return “triggered”. If the signal is inverted, add a “!” In front of the pin definition (ie, pin: ! z:P1.24).</p>

<p>Slowly reduce your Z height and run <code class="language-plaintext highlighter-rouge">QUERY_PROBE</code> each time until <code class="language-plaintext highlighter-rouge">QUERY_PROBE</code> returns “triggered” - make sure the nozzle is not touching the print surface (and has clearance).</p>

<h3 id="probe-accuracy-check">Probe Accuracy Check</h3>

<p>With the bed and hotend cold (for now), move the probe to the center of the bed and run <code class="language-plaintext highlighter-rouge">PROBE_ACCURACY</code>. It will probe the bed 10 times in a row and output a standard deviation value at the end. Make sure that the sensed distance is not trending (gradually decreasing or increasing over the 10 probes) and that the standard deviation is less than 0.003mm.</p>

<p>Example of unstable <code class="language-plaintext highlighter-rouge">PROBE_ACCURACY</code> (trending downward during warm up).</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Send: PROBE_ACCURACY
Recv: // PROBE_ACCURACY at X:125.000 Y:125.000 Z:7.173 (samples=10 retract=2.000 speed=2.0
Send: M105
Recv: // probe at 125.000,125.000 is z=4.975000
Recv: // probe at 125.000,125.000 is z=4.960000
Recv: // probe at 125.000,125.000 is z=4.955000
Recv: // probe at 125.000,125.000 is z=4.952500
Recv: // probe at 125.000,125.000 is z=4.950000
Recv: // probe at 125.000,125.000 is z=4.947500
Recv: // probe at 125.000,125.000 is z=4.942500
Recv: // probe at 125.000,125.000 is z=4.937500
Recv: // probe at 125.000,125.000 is z=4.937500
Recv: // probe at 125.000,125.000 is z=4.932500
Recv: // probe accuracy results: maximum 4.975000, minimum 4.932500, range 0.042500, average 4.949000, median 4.948750,
standard deviation 0.011948
</code></pre></div></div>

<h2 id="pid-tune-bed--hotend">PID Tune Bed &amp; Hotend</h2>

<p>The PID tune is important for tuning the printer for a given hardware configuration to ensure that temperatures can remain as stable as possible during operation.</p>

<h3 id="pid-tune-heated-bed">PID Tune Heated Bed</h3>

<p>Move nozzle to the center of the bed and approximately 5-10mm above the bed surface, then run:</p>

<p><code class="language-plaintext highlighter-rouge">PID_CALIBRATE HEATER=heater_bed TARGET=100</code></p>

<p>It will perform a PID calibration routine that will last about 10 minutes. Once it is finished, type <code class="language-plaintext highlighter-rouge">SAVE_CONFIG</code> which will save the parameters into your configuration file.</p>

<h3 id="pid-tune-hotend">PID Tune Hotend</h3>

<p>Set the part cooling fans to 25% (<code class="language-plaintext highlighter-rouge">M106 S64</code>) and then run:</p>

<p><code class="language-plaintext highlighter-rouge">PID_CALIBRATE HEATER=extruder TARGET=245</code></p>

<p>It will perform a PID calibration routine that will last about 5 minutes. Once it is finished, type <code class="language-plaintext highlighter-rouge">SAVE_CONFIG</code> which will save the parameters into your configuration file.</p>

<h2 id="bed-leveling">Bed Leveling</h2>

<p>Depending on the printer type and capability, the following command(s) are used:</p>

<ul>
  <li>V0: <code class="language-plaintext highlighter-rouge">BED_SCREWS_ADJUST</code></li>
  <li>V1, SW, Legacy: <code class="language-plaintext highlighter-rouge">Z_TILT_ADJUST</code>, <code class="language-plaintext highlighter-rouge">SCREWS_TILT_CALCULATE</code></li>
  <li>V2: <code class="language-plaintext highlighter-rouge">QUAD_GANTRY_LEVEL</code></li>
</ul>

<h3 id="bed-screws-v0">Bed Screws (V0)</h3>

<p>The V0 uses manual bed leveling, the bed is small enough and thick enough that a mesh or other types of per print leveling are not needed. there is a Macro in Klipper to help with the manual bed leveling process 
<code class="language-plaintext highlighter-rouge">BED_SCREWS_ADJUST</code></p>

<p>This tool will move the printer’s nozzle to each screw XY location and then move the nozzle to a Z=0.3 height. At this point one can use the “paper test” to adjust the bed screw directly under the nozzle. See the information described in “the paper test”, but adjust the bed screw instead of commanding the nozzle to different heights. Adjust the bed screw until there is a small amount of friction when pushing the paper back and forth. this process will move all three mounting points of your bed closer to the nozzle so it is critical that you re-run the Z offset adjust after completing this section.</p>

<p>Once the screw is adjusted so that a small amount of friction is felt, run either the <code class="language-plaintext highlighter-rouge">ACCEPT</code> or <code class="language-plaintext highlighter-rouge">ADJUSTED</code> command. Use the <code class="language-plaintext highlighter-rouge">ADJUSTED</code> command if the bed screw needed an adjustment (typically anything more than about 1/8th of a turn of the screw). Use the <code class="language-plaintext highlighter-rouge">ACCEPT</code> command if no significant adjustment is necessary. Both commands will cause the tool to proceed to the next screw. (When an <code class="language-plaintext highlighter-rouge">ADJUSTED</code> command is used, the tool will schedule an additional cycle of bed screw adjustments; the tool completes successfully when all bed screws are verified to not require any significant adjustments.) One can use the <code class="language-plaintext highlighter-rouge">ABORT</code> command to exit the tool early.</p>

<p>After the <code class="language-plaintext highlighter-rouge">BED_SCREWS_ADJUST</code> command has been completed rerun the <code class="language-plaintext highlighter-rouge">Z_ENDSTOP_CALIBRATE</code> command to to bring your nozzle to the correct Z=0 position.</p>

<h3 id="bed-tilt-v1-legacy">Bed Tilt (V1, Legacy)</h3>

<p>The V1 and Legacy use a combination of automated and manual bed leveling.  There are two macros built into Klipper to assist with the function.</p>

<p>First run the <code class="language-plaintext highlighter-rouge">BED_TILT</code> macro.  This will go back and forth between the predefined points to level the two Z motors.  This setting is dynamically changed and nothing will need to be saved.</p>

<p>Second run the <code class="language-plaintext highlighter-rouge">SCREWS_TILT_CALCULATE</code> macro.  It will check the 3 positions defined in the <em>[screws_tilt_adjust section]</em> of printer.cfg for level, then return how much to adjust the front thumbscrew by.  Re-run the process at least one more time to verify the adjustment.</p>

<p>After both processes have been completed rerun the <code class="language-plaintext highlighter-rouge">Z_ENDSTOP_CALIBRATE</code> command to to bring your nozzle to the correct Z=0 position.</p>

<h3 id="z-tilt-trident">Z Tilt (Trident)</h3>

<p>The Trident uses automated bed leveling using 3 motors.  There is a macro <code class="language-plaintext highlighter-rouge">Z_TILT_ADJUST</code> built into Klipper for that function. It is very similar to the QUAD_GANTRY_LEVEL used by V2, but supports 3 or more motors. Run the <code class="language-plaintext highlighter-rouge">Z_TILT_ADJUST</code> and it will probe each of the 3 points 3 times, average the readins, then make adjustments until the grantry is level.</p>

<p>After that process has been completed, rehome z by running <code class="language-plaintext highlighter-rouge">G28 Z</code>, and then rerun the <code class="language-plaintext highlighter-rouge">Z_ENDSTOP_CALIBRATE</code> command to to bring your nozzle to the correct Z=0 position.</p>

<h3 id="quad-gantry-level-v2">Quad Gantry Level (V2)</h3>

<p>Since the V2 uses 4 independent Z motors, the entire gantry system must be specially levelled.  The macro to call this process is <code class="language-plaintext highlighter-rouge">QUAD_GANTRY_LEVEL</code> (sometimes referred to in conversation as ‘QGL’).  It will probe each of 4 points 3 times, average the readings, then make adjustments until the gantry is level.</p>

<p>If the process fails due to an “<em>out of bounds</em>” error, disable your stepper motors and slowly move your gantry or bed by hand until it is approximately flat. Re-home your printer (<code class="language-plaintext highlighter-rouge">G28</code>) and then rerun the sequence. You may have to run it more than once.  Make sure that the adjustment value for each stepper motor converges to 0. If it diverges, check to make sure you have your stepper motors wired to the correct stepper driver (check documentation).</p>

<h3 id="tilt--qgl-with-heated-bed-and-chamber-v1-trident-v2">Tilt / QGL With Heated Bed and Chamber (V1, Trident, V2)</h3>

<p>Run a <code class="language-plaintext highlighter-rouge">G28</code> command to home the printer since a <code class="language-plaintext highlighter-rouge">SAVE_CONFIG</code> restarts the printer.</p>

<p>This will be the first time that a Quad Gantry Level has been run at a high chamber temperature.  To ensure that the probe has stabilized with the heated bed at 100C and the hot end at 240C, run <code class="language-plaintext highlighter-rouge">PROBE_ACCURACY</code> with the nozzle at the center of the bed.  If the values are trending (increasing or decreasing) throughout the 10 probes or the standard deviation is greater than 0.003mm, wait another 5 minutes and try again.</p>

<p>Once the readings are stable, run <code class="language-plaintext highlighter-rouge">Z_TILT_ADJUST</code> or <code class="language-plaintext highlighter-rouge">QUAD_GANTRY_LEVEL</code>.  Make a note of how long the probe readings took to stabilize for when starting prints - typically a cold printer takes 10-20 minutes to stabilize at temperature.</p>

<h4 id="common-qgl-problems">Common QGL Problems</h4>

<ul>
  <li>If the QGL is having issues with too high of a standard deviation and the printer is heated and stable, check Z belt tension.  Make sure they are reasonably tight and even.</li>
  <li>If QGL fails with being unable to reach the probe in time, do a <code class="language-plaintext highlighter-rouge">FIRMWARE_RESTART</code>, manually level the bed as closely as possible, then home (<code class="language-plaintext highlighter-rouge">G28</code>) and re-attempt.</li>
</ul>

<h3 id="bed-mesh-only-switchwire">Bed Mesh Only (Switchwire)</h3>

<p>Crazy things.  More to come.</p>

<h2 id="z-offset-adjustment">Z Offset Adjustment</h2>

<p>If you did not run PID tuning, set your extruder to 245C and heated bed to 100C and let the printer heat up for at least 15 minutes.</p>

<h3 id="initial--simple-process">Initial / Simple Process</h3>

<p>Preparation</p>

<ul>
  <li><strong>V1:</strong> Run a <code class="language-plaintext highlighter-rouge">G28</code>, and then a <code class="language-plaintext highlighter-rouge">Z_TILT_ADJUST</code>, and then another <code class="language-plaintext highlighter-rouge">G28</code>.</li>
  <li><strong>V2:</strong> Run a <code class="language-plaintext highlighter-rouge">G28</code>, and then a <code class="language-plaintext highlighter-rouge">QUAD_GANTRY_LEVEL</code>, and then another <code class="language-plaintext highlighter-rouge">G28</code>.</li>
  <li><strong>All others:</strong>  Run a <code class="language-plaintext highlighter-rouge">G28</code>.</li>
  <li>Move the nozzle to the center of the bed if it is not already.</li>
  <li>Clear any stored bed meshes with <code class="language-plaintext highlighter-rouge">BED_MESH_CLEAR</code></li>
</ul>

<p>Run <code class="language-plaintext highlighter-rouge">Z_ENDSTOP_CALIBRATE</code> (V0, Trident, V2) or <code class="language-plaintext highlighter-rouge">PROBE_CALIBRATE</code> (Switchwire)</p>

<p>Slowly move the nozzle toward the bed by using <code class="language-plaintext highlighter-rouge">TESTZ Z=-1</code>
Until the nozzle is relatively close to the bed, and then stepping down with <code class="language-plaintext highlighter-rouge">TESTZ Z=-0.1</code>
Until the nozzle touches a piece of paper on top of the build plate. If you go far down, you can move the nozzle back up with: <code class="language-plaintext highlighter-rouge">TESTZ Z=0.1</code>
Once you are satisfied with the nozzle height, run <code class="language-plaintext highlighter-rouge">ACCEPT</code> and then <code class="language-plaintext highlighter-rouge">SAVE_CONFIG</code>.</p>

<p><strong>Important:</strong> Klipper assumes that this process is being done cold.  If being performed hot, do an additional <code class="language-plaintext highlighter-rouge">TESTZ Z=-0.1</code> before accepting.</p>

<p>If an “out of bounds” error occurs, send <code class="language-plaintext highlighter-rouge">Z_ENDSTOP_CALIBRATE</code>, <code class="language-plaintext highlighter-rouge">ACCEPT</code>, and then <code class="language-plaintext highlighter-rouge">SAVE_CONFIG</code>. This will redefine the 0 bed height so you will be able to get closer.</p>

<p><strong>V2:</strong> If you get this error it likely means that the shaft for your Z Endstop is too long and may catch on the print head during a print. It is best to cut the shaft or raise the bed (with a washer, for instance) so that it is within 1mm of the build surface.</p>

<h3 id="fine-tuning-z-height">Fine Tuning Z Height</h3>

<h4 id="with-lcd-screen">With LCD Screen</h4>
<p>The Z offset can be adjusted during a print using the Tune menu on the display, and the printer configuration can be updated with this new value. Remember that higher values for the position_endstop means that the nozzle will be closer to the bed.</p>

<h4 id="mainsail-and-fluidd">Mainsail and Fluidd</h4>
<p>The “babystepping” controls may be used to fine tune the z offset.</p>

<h4 id="without-lcd-screen">Without LCD Screen</h4>
<p>If you’re running your printer headless, the Z height can still be adjusted on-the-fly using the web interface.  This is built into Mailsail and Fluidd, but requires some additional work for Octoprint.</p>

<p>1) (Optional) Create macros in your printer.cfg file so that the commands are easier to remember/run:</p>

<div class="language-ini highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">[gcode_macro ZUP]</span>
<span class="err">gcode:</span>
    <span class="err">SET_GCODE_OFFSET</span> <span class="py">Z_ADJUST</span><span class="p">=</span><span class="s">0.01 MOVE=1</span>

<span class="nn">[gcode_macro ZDOWN]</span>
<span class="err">gcode:</span>
    <span class="err">SET_GCODE_OFFSET</span> <span class="py">Z_ADJUST</span><span class="p">=</span><span class="s">-0.01 MOVE=1</span>
</code></pre></div></div>

<p>2) Run ZUP or ZDOWN (or the associated <code class="language-plaintext highlighter-rouge">SET_GCODE_OFFSET</code> command) as needed in the terminal window until you have perfected your squish.
3) Run <code class="language-plaintext highlighter-rouge">GET_POSITION</code> and look for “gcode base”. <em>Note the Z value</em>.</p>

<h4 id="saving-your-results--v0trident-v2">Saving your results  (V0,Trident, V2)</h4>
<p>All of the above methods are “transient”.  The changes are lost as soon as your printer restarts.  Once you find an adjustment you are happy with, you may make it permanent, by applying it to the <code class="language-plaintext highlighter-rouge">position_endstop</code> in your config file:
run the command <code class="language-plaintext highlighter-rouge">Z_OFFSET_APPLY_ENDSTOP</code> followed by <code class="language-plaintext highlighter-rouge">SAVE_CONFIG</code>.  This will restart your printer, with the adjustment permanently applied to the endstop position.</p>

<h4 id="saving-your-results--switchwire">Saving your results  (Switchwire)</h4>
<p>All of the above methods are “transient”.  The changes are lost as soon as your printer restarts.  Once you find an adjustment you are happy with, you may make it permanent, by applying it to the probe’s <code class="language-plaintext highlighter-rouge">z_offset</code> in your config file:
run the command <code class="language-plaintext highlighter-rouge">Z_OFFSET_APPLY_PROBE</code> followed by <code class="language-plaintext highlighter-rouge">SAVE_CONFIG</code>.  This will restart your printer, with the adjustment permanently applied to the probe offset.</p>

<blockquote>
  <h3 id="community-references">Community References</h3>

  <p><a href="../../community/howto/120decibell/z_endstop_configuration.html">Z Endstop Configuration</a></p>

</blockquote>

<h2 id="extruder-calibration-e-steps">Extruder Calibration (e-steps)</h2>

<p>Before the first print,make sure that the extruder extrudes the correct amount of material.</p>

<ul>
  <li>With the hotend at temperature, make a mark between your roll of filament and your extruder, between 120mm and 150mm away from the entrance to the extruder.  Measure the distance from the extrance of the extruder to that mark.</li>
  <li>In Octoprint / Mailsail, extrude 50mm 2 times (for a total of 100mm since Klipper doesn’t allow you to extrude more than 50mm at a time).</li>
  <li>Measure from the entrance of your extruder to the mark you made previously.
    <ul>
      <li><em>In a perfect world, assuming the mark is at 120mm, it would measure 20mm (120mm - 20mm = 100mm), but usually won’t be.</em></li>
    </ul>
  </li>
  <li>Update rotation_distance in the extruder section of the configuration file using this formula:
    <ul>
      <li>New Config Value = Old Config Value * (Actual Extruded Amount/Target Extruded Amount)</li>
    </ul>
  </li>
</ul>

<p><em>Note: a higher configuration value means that less filament is being extruded.</em></p>

<p>Paste the new value into the configuration file, restart Klipper, and try again. Once the extrusion amount is within 0.5% of the target value (ie, 99.5-100.5mm for a target 100mm of extruded filament), the extruder is calibrated!</p>

<p>Typical rotation_distance values should be around 22.6789511 for Afterburner and Mobius (update gear_ratio to 80:20 for Mobius).</p>

<hr />
<h3 id="next-slicer-setup">Next: <a href="../slicer/index.md">Slicer Setup</a></h3>
